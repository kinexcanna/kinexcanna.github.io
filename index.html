<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Michigan Cannabis Metrc ROI Calculator - Kinex Tech Solutions</title>
    <meta name="description" content="Calculate your Metrc compliance automation ROI with Michigan 280E tax savings. Free calculator for Michigan cannabis businesses.">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        import React, { useState } from 'react';
import { Calculator, TrendingUp, DollarSign, Clock, AlertTriangle, FileText } from 'lucide-react';

const MetrcROICalculator = () => {
  const [inputs, setInputs] = useState({
    weeklyHours: '',
    laborCost: '',
    systemCost: '',
    finesAvoided: '',
    efficiency: '90',
    licenseType: 'adult-use'
  });

  const [results, setResults] = useState(null);

  const calculateROI = () => {
    const A = parseFloat(inputs.weeklyHours) || 0;
    const B = parseFloat(inputs.laborCost) || 0;
    const C = parseFloat(inputs.efficiency) / 100 || 0.90;
    const D = parseFloat(inputs.systemCost) || 0;
    const E = parseFloat(inputs.finesAvoided) || 0;

    const currentAnnualCost = A * 52 * B;
    const annualLaborSavings = currentAnnualCost * C;
    const annualValueSavings = annualLaborSavings + E;
    const roi = ((annualValueSavings - D) / D) * 100;
    const breakEvenMonths = D / (annualValueSavings / 12);
    const hoursReallocated = A * 52 * C;

    const michiganTaxRate = 0.06;
    const taxSavings = inputs.licenseType === 'adult-use' 
      ? annualLaborSavings * michiganTaxRate 
      : 0;

    const totalFirstYearValue = annualValueSavings + taxSavings;
    const adjustedROI = ((totalFirstYearValue - D) / D) * 100;

    setResults({
      currentAnnualCost: currentAnnualCost.toFixed(0),
      annualLaborSavings: annualLaborSavings.toFixed(0),
      finesAvoided: E.toFixed(0),
      taxSavings: taxSavings.toFixed(0),
      totalFirstYearValue: totalFirstYearValue.toFixed(0),
      systemCost: D.toFixed(0),
      roi: adjustedROI.toFixed(0),
      breakEvenMonths: breakEvenMonths.toFixed(1),
      hoursReallocated: hoursReallocated.toFixed(0),
      monthlyLaborSavings: (annualLaborSavings / 12).toFixed(0),
      threeYearValue: (totalFirstYearValue * 3).toFixed(0)
    });
  };

  const resetCalculator = () => {
    setInputs({
      weeklyHours: '',
      laborCost: '',
      systemCost: '',
      finesAvoided: '',
      efficiency: '90',
      licenseType: 'adult-use'
    });
    setResults(null);
  };

  return (
    <div className="max-w-4xl mx-auto p-6 bg-gradient-to-br from-green-50 to-emerald-50 min-h-screen">
      <div className="bg-white rounded-xl shadow-2xl p-8">
        <div className="text-center mb-8">
          <div className="flex justify-center mb-4">
            <div className="p-3 bg-green-600 rounded-full">
              <Calculator className="w-12 h-12 text-white" />
            </div>
          </div>
          <h1 className="text-3xl font-bold text-gray-900 mb-2">
            Michigan Cannabis Metrc ROI Calculator
          </h1>
          <p className="text-gray-600">
            Calculate your compliance automation savings & ROI with Michigan tax benefits
          </p>
          <div className="mt-4 flex justify-center gap-2">
            <span className="px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-semibold">
              Michigan Specific
            </span>
            <span className="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-semibold">
              280E Tax Savings
            </span>
          </div>
        </div>

        {!results ? (
          <div className="space-y-6">
            <div className="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6">
              <div className="flex items-start">
                <AlertTriangle className="w-5 h-5 text-blue-500 mt-0.5 mr-3 flex-shrink-0" />
                <div>
                  <h3 className="font-semibold text-blue-900 mb-1">Michigan-Specific Calculator</h3>
                  <p className="text-sm text-blue-800">
                    This calculator includes Michigan's Section 280E decoupling benefits for adult-use operators,
                    potentially adding 6% in tax savings on labor costs.
                  </p>
                </div>
              </div>
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                License Type *
              </label>
              <select
                value={inputs.licenseType}
                onChange={(e) => setInputs({...inputs, licenseType: e.target.value})}
                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"
              >
                <option value="adult-use">Adult-Use Retail (280E tax savings apply)</option>
                <option value="medical">Medical Marijuana (No 280E savings)</option>
                <option value="provisioning">Provisioning Center</option>
                <option value="cultivator">Cultivator/Processor</option>
              </select>
              {inputs.licenseType === 'adult-use' && (
                <p className="mt-2 text-sm text-green-600 flex items-center gap-1">
                  <TrendingUp className="w-4 h-4" />
                  Michigan adult-use operators benefit from 280E decoupling - includes 6% tax savings!
                </p>
              )}
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Weekly Hours Spent on Metrc Compliance *
              </label>
              <input
                type="number"
                value={inputs.weeklyHours}
                onChange={(e) => setInputs({...inputs, weeklyHours: e.target.value})}
                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"
                placeholder="e.g., 20"
                min="0"
                step="0.5"
              />
              <p className="mt-1 text-sm text-gray-500">
                Include time for data entry, corrections, inventory tracking, and compliance reporting
              </p>
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Average Hourly Labor Cost *
              </label>
              <div className="relative">
                <span className="absolute left-3 top-2 text-gray-500">$</span>
                <input
                  type="number"
                  value={inputs.laborCost}
                  onChange={(e) => setInputs({...inputs, laborCost: e.target.value})}
                  className="w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"
                  placeholder="e.g., 25"
                  min="0"
                  step="0.50"
                />
              </div>
              <p className="mt-1 text-sm text-gray-500">
                Include wages + benefits. Michigan budtender average: $20-35/hour
              </p>
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Automation System Cost (Annual) *
              </label>
              <div className="relative">
                <span className="absolute left-3 top-2 text-gray-500">$</span>
                <input
                  type="number"
                  value={inputs.systemCost}
                  onChange={(e) => setInputs({...inputs, systemCost: e.target.value})}
                  className="w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"
                  placeholder="e.g., 12000"
                  min="0"
                />
              </div>
              <p className="mt-1 text-sm text-gray-500">
                Total first-year cost including setup, licensing, training, and support
              </p>
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Annual Compliance Fines Avoided *
              </label>
              <div className="relative">
                <span className="absolute left-3 top-2 text-gray-500">$</span>
                <input
                  type="number"
                  value={inputs.finesAvoided}
                  onChange={(e) => setInputs({...inputs, finesAvoided: e.target.value})}
                  className="w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"
                  placeholder="e.g., 5000"
                  min="0"
                />
              </div>
              <p className="mt-1 text-sm text-gray-500">
                Michigan CRA violations: $500-10,000+ per incident. Conservative estimate recommended.
              </p>
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Expected Efficiency Gain: {inputs.efficiency}%
              </label>
              <input
                type="range"
                value={inputs.efficiency}
                onChange={(e) => setInputs({...inputs, efficiency: e.target.value})}
                className="w-full"
                min="50"
                max="95"
                step="5"
              />
              <div className="flex justify-between text-xs text-gray-500 mt-1">
                <span>50% (Conservative)</span>
                <span>75% (Moderate)</span>
                <span>95% (Aggressive)</span>
              </div>
            </div>

            <button
              onClick={calculateROI}
              disabled={!inputs.weeklyHours || !inputs.laborCost || !inputs.systemCost}
              className="w-full py-4 bg-green-600 text-white rounded-lg font-bold text-lg hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors shadow-lg"
            >
              Calculate My ROI →
            </button>
          </div>
        ) : (
          <div className="space-y-8">
            <div className="text-center">
              <h2 className="text-3xl font-bold text-gray-900 mb-2">Your ROI Analysis</h2>
              <p className="text-gray-600">
                {inputs.licenseType === 'adult-use' ? 'Adult-Use' : 
                 inputs.licenseType === 'medical' ? 'Medical' :
                 inputs.licenseType === 'provisioning' ? 'Provisioning Center' : 'Cultivator'} License
                {inputs.licenseType === 'adult-use' && ' (with Michigan 280E tax benefits)'}
              </p>
            </div>

            <div className="grid md:grid-cols-2 gap-6">
              <div className="bg-gradient-to-br from-green-50 to-emerald-100 rounded-xl p-6 border-2 border-green-200">
                <div className="flex items-center justify-between mb-4">
                  <h3 className="text-xl font-bold text-gray-900">ROI</h3>
                  <TrendingUp className="w-8 h-8 text-green-600" />
                </div>
                <div className="text-center">
                  <div className="text-6xl font-bold text-green-600 mb-2">{results.roi}%</div>
                  <div className="text-sm text-gray-600">First Year Return</div>
                  <div className="mt-4 p-3 bg-white rounded-lg">
                    <div className="text-xs text-gray-500 mb-1">Break-Even Point</div>
                    <div className="text-2xl font-bold text-gray-900">{results.breakEvenMonths} months</div>
                  </div>
                </div>
              </div>

              <div className="bg-gradient-to-br from-blue-50 to-indigo-100 rounded-xl p-6 border-2 border-blue-200">
                <div className="flex items-center justify-between mb-4">
                  <h3 className="text-xl font-bold text-gray-900">Total Value</h3>
                  <DollarSign className="w-8 h-8 text-blue-600" />
                </div>
                <div className="text-center">
                  <div className="text-5xl font-bold text-blue-600 mb-2">
                    ${parseInt(results.totalFirstYearValue).toLocaleString()}
                  </div>
                  <div className="text-sm text-gray-600 mb-4">First Year Savings</div>
                  <div className="text-sm text-gray-700">
                    <div className="font-semibold">3-Year Projection:</div>
                    <div className="text-2xl font-bold text-blue-600 mt-1">
                      ${parseInt(results.threeYearValue).toLocaleString()}
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div className="bg-gray-50 rounded-xl p-6">
              <h3 className="text-xl font-bold text-gray-900 mb-4 flex items-center gap-2">
                <FileText className="w-6 h-6 text-gray-600" />
                Detailed Breakdown
              </h3>
              <div className="space-y-3">
                <div className="flex justify-between items-center border-b border-gray-200 pb-2">
                  <span className="text-gray-700">Current Annual Labor Cost</span>
                  <span className="font-semibold text-red-600">
                    -${parseInt(results.currentAnnualCost).toLocaleString()}
                  </span>
                </div>
                <div className="flex justify-between items-center border-b border-gray-200 pb-2">
                  <span className="text-gray-700">Annual Labor Savings ({inputs.efficiency}% efficiency)</span>
                  <span className="font-semibold text-green-600">
                    +${parseInt(results.annualLaborSavings).toLocaleString()}
                  </span>
                </div>
                {inputs.licenseType === 'adult-use' && (
                  <div className="flex justify-between items-center border-b border-gray-200 pb-2">
                    <span className="text-gray-700">Michigan 280E Tax Savings (6%)</span>
                    <span className="font-semibold text-green-600">
                      +${parseInt(results.taxSavings).toLocaleString()}
                    </span>
                  </div>
                )}
                <div className="flex justify-between items-center border-b border-gray-200 pb-2">
                  <span className="text-gray-700">Compliance Fines Avoided</span>
                  <span className="font-semibold text-green-600">
                    +${parseInt(results.finesAvoided).toLocaleString()}
                  </span>
                </div>
                <div className="flex justify-between items-center border-b border-gray-200 pb-2">
                  <span className="text-gray-700">System Investment</span>
                  <span className="font-semibold text-red-600">
                    -${parseInt(results.systemCost).toLocaleString()}
                  </span>
                </div>
                <div className="flex justify-between items-center pt-2">
                  <span className="text-lg font-bold text-gray-900">Net First Year Benefit</span>
                  <span className="text-2xl font-bold text-green-600">
                    ${(parseInt(results.totalFirstYearValue) - parseInt(results.systemCost)).toLocaleString()}
                  </span>
                </div>
              </div>
            </div>

            <div className="bg-blue-50 rounded-xl p-6 border-2 border-blue-200">
              <h3 className="text-xl font-bold text-gray-900 mb-4 flex items-center gap-2">
                <Clock className="w-6 h-6 text-blue-600" />
                Time Savings Impact
              </h3>
              <div className="grid md:grid-cols-3 gap-4">
                <div className="text-center">
                  <div className="text-3xl font-bold text-blue-600 mb-1">{results.hoursReallocated}</div>
                  <div className="text-sm text-gray-600">Hours Freed Annually</div>
                </div>
                <div className="text-center">
                  <div className="text-3xl font-bold text-blue-600 mb-1">
                    {(parseInt(results.hoursReallocated) / 52).toFixed(0)}
                  </div>
                  <div className="text-sm text-gray-600">Hours Saved Per Week</div>
                </div>
                <div className="text-center">
                  <div className="text-3xl font-bold text-blue-600 mb-1">
                    ${parseInt(results.monthlyLaborSavings).toLocaleString()}
                  </div>
                  <div className="text-sm text-gray-600">Monthly Savings</div>
                </div>
              </div>
              <div className="mt-4 p-4 bg-white rounded-lg">
                <p className="text-sm text-gray-700">
                  <strong>Strategic Value:</strong> Reallocate {(parseInt(results.hoursReallocated) / 52).toFixed(0)} hours per week 
                  to customer service, product development, or expansion planning instead of compliance paperwork.
                </p>
              </div>
            </div>

            <div className="bg-gradient-to-br from-yellow-50 to-orange-50 rounded-xl p-6 border-2 border-yellow-200">
              <h3 className="text-xl font-bold text-gray-900 mb-3 flex items-center gap-2">
                <AlertTriangle className="w-6 h-6 text-yellow-600" />
                Risk Mitigation Value
              </h3>
              <div className="space-y-3">
                <div className="flex items-start gap-3">
                  <div className="w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center flex-shrink-0">
                    <span className="text-yellow-600 font-bold">1</span>
                  </div>
                  <div>
                    <div className="font-semibold text-gray-900">Compliance Risk Reduction</div>
                    <p className="text-sm text-gray-600">
                      Automated systems reduce human error, helping avoid Michigan CRA violations ($500-$10,000+ per incident)
                    </p>
                  </div>
                </div>
                <div className="flex items-start gap-3">
                  <div className="w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center flex-shrink-0">
                    <span className="text-yellow-600 font-bold">2</span>
                  </div>
                  <div>
                    <div className="font-semibold text-gray-900">License Protection</div>
                    <p className="text-sm text-gray-600">
                      Serious violations can result in license suspension or revocation - your most valuable asset
                    </p>
                  </div>
                </div>
                <div className="flex items-start gap-3">
                  <div className="w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center flex-shrink-0">
                    <span className="text-yellow-600 font-bold">3</span>
                  </div>
                  <div>
                    <div className="font-semibold text-gray-900">Audit Readiness</div>
                    <p className="text-sm text-gray-600">
                      Instant access to compliant records during surprise audits prevents operational disruption
                    </p>
                  </div>
                </div>
              </div>
            </div>

            {inputs.licenseType === 'adult-use' && (
              <div className="bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-6 border-2 border-purple-200">
                <h3 className="text-xl font-bold text-gray-900 mb-3">
                  Michigan Adult-Use Tax Advantage
                </h3>
                <p className="text-gray-700 mb-4">
                  Michigan's Section 280E decoupling allows adult-use cannabis businesses to deduct 
                  ordinary business expenses (including labor costs) from state taxes - a benefit not 
                  available in most states.
                </p>
                <div className="bg-white rounded-lg p-4">
                  <div className="flex justify-between items-center">
                    <span className="font-semibold text-gray-900">Your Additional Tax Savings:</span>
                    <span className="text-2xl font-bold text-purple-600">
                      ${parseInt(results.taxSavings).toLocaleString()}/year
                    </span>
                  </div>
                </div>
              </div>
            )}

            <div className="bg-gradient-to-r from-green-600 to-emerald-600 rounded-xl p-8 text-white text-center">
              <h3 className="text-2xl font-bold mb-3">Ready to Realize These Savings?</h3>
              <p className="text-green-100 mb-6">
                Kinex Tech Solutions specializes in Michigan cannabis compliance automation. 
                Let's discuss how to implement these systems for your operation.
              </p>
              <div className="flex flex-col sm:flex-row gap-4 justify-center">
                <button className="px-8 py-4 bg-white text-green-600 rounded-lg font-bold text-lg hover:bg-green-50 transition-colors shadow-lg">
                  Schedule Consultation
                </button>
                <button 
                  onClick={() => window.print()}
                  className="px-8 py-4 bg-green-700 text-white rounded-lg font-bold text-lg hover:bg-green-800 transition-colors border-2 border-white"
                >
                  Download Analysis (PDF)
                </button>
              </div>
              <p className="mt-4 text-sm text-green-200">
                Free consultation • Michigan cannabis specialist • Local support
              </p>
            </div>

            <div className="text-center">
              <button
                onClick={resetCalculator}
                className="text-green-600 hover:text-green-700 font-semibold underline"
              >
                ← Calculate Another Scenario
              </button>
            </div>
          </div>
        )}
      </div>

      <div className="text-center mt-8 text-gray-600 text-sm">
        <p>© 2025 Kinex Tech Solutions | Michigan Cannabis Compliance Specialists</p>
        <p className="mt-2">Metrc Automation • Compliance Consulting • IT Support</p>
      </div>
    </div>
  );
};

export default MetrcROICalculator;
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MetrcROICalculator />);
    </script>
</body>
</html>
